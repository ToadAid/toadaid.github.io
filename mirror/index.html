<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Mirror | The Digital Pond</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@300;400&display=swap');

    :root{
      --safe-t: env(safe-area-inset-top);
      --safe-b: env(safe-area-inset-bottom);
      --safe-l: env(safe-area-inset-left);
      --safe-r: env(safe-area-inset-right);

      --pad-top: calc(14px + var(--safe-t));
      --pad-bot: calc(18px + var(--safe-b));
      --pad-x: 16px;

      --shell-max: 1024px;

      --card-max: 720px;
      --card-min: 520px;
    }

    html, body {
      height: 100%;
      margin: 0;
      background-color: #030303;
      color: #d1d1d1;
      font-family: 'Inter', sans-serif;
      overflow: hidden;
      -webkit-text-size-adjust: 100%;
      text-size-adjust: 100%;
    }

    body{
      padding: var(--pad-top) calc(var(--pad-x) + var(--safe-r)) var(--pad-bot) calc(var(--pad-x) + var(--safe-l));
      display: grid;
      grid-template-rows: auto 1fr auto;
      gap: 14px;
      overflow: hidden;
    }

    .water-bg{
      position: fixed;
      inset: 0;
      background:
        radial-gradient(1200px 800px at 50% 35%, rgba(16,185,129,0.06), transparent 55%),
        radial-gradient(900px 600px at 50% 70%, rgba(255,255,255,0.03), transparent 60%),
        linear-gradient(rgba(0,0,0,0.92), rgba(0,0,0,0.98));
      z-index: -1;
    }

    .serif { font-family: 'Cinzel', serif; }

    .shell{
      width: 100%;
      max-width: var(--shell-max);
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 14px;
    }

    .middle{
      min-height: 0;
      width: 100%;
      max-width: var(--shell-max);
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .manual-text { font-size: 0.7rem; color:#888; line-height:1.4; }

    .top-right{
      display:flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 8px;
      margin-top: 2px;
    }

    .pond-tag{
      font-size: 10px;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.30);
      user-select:none;
      white-space: nowrap;
    }

    input{
      background: rgba(255,255,255,0.05) !important;
      border: 1px solid rgba(255,255,255,0.1) !important;
      border-radius: 10px;
    }

    .portal{
      position: relative;
      overflow: hidden;
      box-sizing: border-box;

      width: min(100%, var(--card-max));
      height: min(100%, var(--card-max));
      min-height: var(--card-min);
      max-height: 100%;

      border-radius: 32px;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(0,0,0,0.42);
      backdrop-filter: blur(10px);
      box-shadow: 0 0 120px rgba(0,0,0,0.78);

      display: flex;
      flex-direction: column;
      padding: 18px;
    }

    .portal::after{
      content:'';
      position:absolute;
      inset: 2px;
      border-radius: 30px;
      border: 1px solid rgba(16,185,129,0.12);
      animation:pulse 8s infinite;
      pointer-events:none;
    }

    @keyframes pulse{
      0%,100%{opacity:0.18;transform:scale(1)}
      50%{opacity:0.55;transform:scale(1.01)}
    }

    .tap-header{
      width: 100%;
      display:flex;
      align-items:center;
      justify-content: flex-end;
      user-select:none;
      margin-bottom: 10px;
    }

    .tap-pill{
      font-size: 10px;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: rgba(16,185,129,0.65);
      border: 1px solid rgba(16,185,129,0.28);
      padding: 8px 12px;
      border-radius: 9999px;
      background: rgba(16,185,129,0.06);
    }

    .portal-scroll{
      flex: 1;
      min-height: 0;
      overflow: auto;
      -webkit-overflow-scrolling: touch;
      padding: 6px 10px 16px;
      mask-image: linear-gradient(to bottom, transparent 0px, black 16px, black calc(100% - 18px), transparent 100%);
    }

    .portal, .portal-scroll{
      touch-action: pan-y;
      overscroll-behavior: contain;
      -webkit-overflow-scrolling: touch;
    }

    .title-wrap{
      text-align:center;
      padding-top: 4px;
    }
    .title-tap-zone{
      display:inline-block;
      padding: 10px 6px;
      cursor: pointer;
    }

    .portal h1{
      font-size: 40px;
      letter-spacing: 0.36em;
      color: #fff;
      margin: 0 0 6px;
    }
    .subtitle{
      font-size: 12px;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.45);
      margin: 0 0 16px;
    }

    .preset-row{
      width: 100%;
      display:flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin-bottom: 14px;
    }

    .preset{
      background: rgba(10,10,10,0.55);
      border: 1px solid rgba(255,255,255,0.10);
      color: rgba(255,255,255,0.78);
      padding: 10px 16px;
      border-radius: 9999px;
      font-size: 11px;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      transition: 160ms ease;
      user-select:none;
      white-space: nowrap;
    }
    .preset:hover{ border-color: rgba(16,185,129,0.55); }
    .preset.active{
      border-color: rgba(16,185,129,0.65) !important;
      box-shadow: 0 0 0 1px rgba(16,185,129,0.18), 0 0 22px rgba(16,185,129,0.12);
      background: rgba(16,185,129,0.06) !important;
      color: rgba(255,255,255,0.92);
    }

    .affordance{
      margin: 8px auto 10px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap: 10px;
      color: rgba(255,255,255,0.28);
      font-size: 11px;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      user-select:none;
    }
    .chev{
      width: 26px;
      height: 26px;
      border-radius: 9999px;
      border: 1px solid rgba(255,255,255,0.10);
      display:flex;
      align-items:center;
      justify-content:center;
      color: rgba(255,255,255,0.35);
      background: rgba(0,0,0,0.25);
    }

    #reflection-output{
      text-align:center;
      padding: 4px 6px 0;
      opacity: 1;
    }

    #main-text{
      font-style: italic;
      font-size: 22px;
      line-height: 1.8;
      color: rgba(255,255,255,0.85);
      margin: 0 0 16px;
    }

    .mini-lines{
      font-size: 10px;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      font-weight: 700;
      margin-bottom: 14px;
    }
    #echo-text{ color: rgba(16,185,129,0.82); margin:0 0 8px; }
    #res-text{ color: rgba(255,255,255,0.42); margin:0; }

    #guide-text{
      font-size: 14px;
      font-style: italic;
      color: rgba(255,255,255,0.30);
      margin: 0 0 8px;
      line-height: 1.7;
    }

    .sigils{
      font-size: 22px;
      letter-spacing: 0.55rem;
      opacity: .85;
      padding-bottom: 6px;
    }

    .ripple-overlay{
      position:absolute;
      inset:0;
      pointer-events:none;
      opacity:0;
      transition: opacity .25s ease;
      background: radial-gradient(circle at 50% 60%, rgba(16,185,129,0.08), transparent 55%);
    }
    .portal.listening .ripple-overlay{ opacity:1; }

    .ripple-overlay::before,
    .ripple-overlay::after{
      content:"";
      position:absolute;
      left:50%;
      top:60%;
      width:16px;height:16px;
      transform:translate(-50%,-50%);
      border-radius:9999px;
      border:1px solid rgba(16,185,129,0.28);
      opacity:0;
    }
    .portal.listening .ripple-overlay::before{
      animation: pondRipple 1.35s ease-out infinite;
      opacity:1;
    }
    .portal.listening .ripple-overlay::after{
      animation: pondRipple 1.35s ease-out infinite;
      animation-delay:.35s;
      border-color: rgba(16,185,129,0.18);
      opacity:1;
    }

    @keyframes pondRipple{
      0%{width:16px;height:16px;opacity:.75}
      70%{width:520px;height:520px;opacity:.10}
      100%{width:620px;height:620px;opacity:0}
    }

    .portal.expanded{
      height: 100%;
      width: min(100%, var(--card-max));
      max-height: 100%;
    }
    .portal.expanded .tap-pill{ color: rgba(16,185,129,0.50); }

    #reflect-btn:active{ transform: translateY(1px); }

    .sheet{
      position:fixed;
      left:0; right:0;
      bottom:-75%;
      height:75%;
      background: rgba(5,5,5,0.92);
      border-top: 1px solid rgba(255,255,255,0.08);
      backdrop-filter: blur(10px);
      transition: bottom .35s ease;
      z-index:50;
      padding-bottom: calc(16px + var(--safe-b));
    }
    .sheet.open{ bottom:0; }
    .sheet-handle{
      width:64px; height:4px;
      border-radius:9999px;
      background: rgba(255,255,255,0.18);
      margin: 10px auto;
    }

    @media (max-width: 520px){
      .portal{
        width: 100%;
        min-height: 0;
        height: 100%;
        border-radius: 28px;
        padding: 14px;
      }
      .portal::after{ border-radius: 26px; }
      .portal h1{ font-size: 34px; letter-spacing: 0.32em; }
      #main-text{ font-size: 20px; }
      .preset{ padding: 10px 14px; }
    }

    @media (prefers-reduced-motion: reduce){
      .portal::after{ animation:none; }
      .portal.listening .ripple-overlay::before,
      .portal.listening .ripple-overlay::after{ animation:none !important; }
    }
  </style>
</head>

<body>
  <div class="water-bg"></div>

  <div class="shell w-full z-10">
    <button id="manual-toggle"
      class="manual-text max-w-xs uppercase tracking-tighter text-left hover:text-zinc-200 transition"
      aria-label="Toggle manual">
      <span class="text-emerald-500 font-bold">The Manual for the Fallen</span><br>
      <span class="manual-lines">
        I. The Three Breaths: Acknowledge, Release, Inquire.<br>
        II. The Law of the Question: Character over Capital.<br>
        III. Stillness Yields Truth.
      </span>
    </button>

    <div class="top-right">
      <div class="pond-tag">POND ‚Ä¢ v0.1</div>
      <button id="wallet-btn"
        class="bg-zinc-900/80 border border-zinc-700 px-4 py-2 text-[10px] uppercase tracking-widest rounded hover:border-emerald-500 transition">
        Connect Wallet (Base)
      </button>
    </div>
  </div>

  <div class="middle">
    <div class="portal text-center" id="portal">
      <div class="ripple-overlay"></div>

      <div class="tap-header">
        <div class="tap-pill" id="tap-pill">Tap to Expand</div>
      </div>

      <div class="portal-scroll" id="portal-scroll">
        <div class="title-wrap">
          <div class="title-tap-zone" id="title-tap-zone" aria-label="Tap to expand or collapse">
            <h1 class="serif">MIRROR</h1>
            <p class="serif subtitle">The Digital Pond</p>
          </div>
        </div>

        <div class="preset-row">
          <button class="preset" data-text="Mirror, I feel lost. What should I do today?">Lost</button>
          <button class="preset" data-text="Mirror, what does stillness mean for me today?">Stillness</button>
          <button class="preset" data-text="Mirror, what does patience mean when nothing moves?">Patience</button>
          <button class="preset" data-text="Mirror, what does it mean to become who I already am?">Becoming</button>
          <button class="preset" data-text="Explain ‚ÄúToby = The People‚Äù to a beginner, in a calm and simple way.">Toby = The People</button>
        </div>

        <div class="affordance" id="affordance">
          <span class="chev">‚åÑ</span>
          <span>Swipe to read</span>
          <span class="chev">‚åÉ</span>
        </div>

        <div id="reflection-output">
          <p id="main-text">‚ÄúStillness yields truth.‚Äù</p>

          <div class="mini-lines">
            <p id="echo-text">ECHO: STILLNESS YIELDS TRUTH</p>
            <p id="res-text">RESONANCE: ROOTS DEEPEN.</p>
          </div>

          <p id="guide-text">What remains when urgency leaves?</p>
          <div class="sigils">‚öõÔ∏è ‚âã üçÉ üåÄ</div>

          <div id="err" class="mt-4 hidden text-[11px] text-red-300">
            The pond could not hear the ocean. Check endpoint health.
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="shell w-full z-10 space-y-3" style="flex-direction: column; align-items: stretch;">
    <div class="flex gap-2">
      <input id="user-input" type="text" placeholder="Inquire the Pond (Type your question... Enter to reflect)"
        class="flex-grow p-3 text-sm text-emerald-300 placeholder-zinc-700 focus:outline-none focus:ring-2 focus:ring-emerald-600/30"
        aria-label="Your inquiry" />
      <button id="reflect-btn"
        class="bg-zinc-800 border border-zinc-600 px-6 py-2 text-xs uppercase tracking-widest hover:bg-emerald-600 hover:text-black transition duration-500 rounded-lg"
        aria-label="Reflect">
        Reflect
      </button>
    </div>

    <div class="flex justify-between items-center text-[10px] text-zinc-500 uppercase tracking-widest">
      <div class="flex items-center gap-2">
        üçÉ <span id="leaves">Leaves of Stillness: 0</span>
      </div>
      <div class="flex items-center gap-4">
        <button id="history-btn" class="hover:text-white transition">History ‚Üü</button>
        <button id="basescan-btn" class="hover:text-white transition">View Karmic Record on BaseScan ‚Üó</button>
      </div>
    </div>
  </div>

  <div id="sheet" class="sheet">
    <div class="sheet-handle"></div>
    <div class="px-5 pb-4 flex items-center justify-between">
      <div class="text-xs uppercase tracking-widest text-zinc-400">Karmic Record (Local)</div>
      <div class="flex gap-3">
        <button id="clear-history" class="text-[10px] uppercase tracking-widest text-zinc-500 hover:text-red-300 transition">Clear</button>
        <button id="close-sheet" class="text-[10px] uppercase tracking-widest text-zinc-500 hover:text-white transition">Close</button>
      </div>
    </div>
    <div id="history-list" class="px-5 overflow-auto" style="height: calc(75% - 64px);"></div>
  </div>

  <script>
    const API_URL = "https://toadaid.duckdns.org/ask";
    const KEY_LEAVES = "mirror_leaves";
    const KEY_HISTORY = "mirror_history_v1";

    const input = document.getElementById("user-input");
    const reflectBtn = document.getElementById("reflect-btn");
    const leavesEl = document.getElementById("leaves");
    const historyBtn = document.getElementById("history-btn");
    const sheet = document.getElementById("sheet");
    const historyList = document.getElementById("history-list");
    const portalEl = document.getElementById("portal");
    const portalScroll = document.getElementById("portal-scroll");
    const affordance = document.getElementById("affordance");

    const mainText = document.getElementById("main-text");
    const echoText = document.getElementById("echo-text");
    const resText  = document.getElementById("res-text");
    const guideText= document.getElementById("guide-text");
    const err = document.getElementById("err");

    const tapPill = document.getElementById("tap-pill");
    const tapHeader = document.querySelector(".tap-header");
    const titleTapZone = document.getElementById("title-tap-zone");

    let isExpanded = false;

    function setExpanded(next){
      isExpanded = !!next;
      portalEl.classList.toggle("expanded", isExpanded);
      tapPill.textContent = isExpanded ? "Tap to Collapse" : "Tap to Expand";

      if(!isExpanded){
        portalScroll.scrollTo({ top: 0, behavior: "smooth" });
      }

      updateScrollAffordance();
    }

    function toggleExpanded(){
      setExpanded(!isExpanded);
    }

    function bindTapToggle(el){
      let sx=0, sy=0, moved=false, pid=null;
      el.addEventListener("pointerdown", (e) => {
        pid = e.pointerId;
        sx = e.clientX; sy = e.clientY;
        moved = false;
      }, {passive:true});
      el.addEventListener("pointermove", (e) => {
        if(pid !== e.pointerId) return;
        if(Math.abs(e.clientX - sx) > 10 || Math.abs(e.clientY - sy) > 10) moved = true;
      }, {passive:true});
      el.addEventListener("pointerup", (e) => {
        if(pid !== e.pointerId) return;
        if(!moved) toggleExpanded();
        pid = null;
      }, {passive:true});
      el.addEventListener("pointercancel", () => { pid=null; }, {passive:true});
    }
    bindTapToggle(tapHeader);
    bindTapToggle(titleTapZone);

    function updateScrollAffordance(){
      const canScroll = portalScroll.scrollHeight > portalScroll.clientHeight + 8;
      affordance.style.opacity = canScroll ? "1" : "0";
      affordance.style.pointerEvents = canScroll ? "auto" : "none";
    }
    window.addEventListener("resize", updateScrollAffordance);
    setTimeout(updateScrollAffordance, 250);

    function loadLeaves(){
      const n = Number(localStorage.getItem(KEY_LEAVES) || "0");
      leavesEl.textContent = `Leaves of Stillness: ${n}`;
    }
    function incLeaves(){
      const n = Number(localStorage.getItem(KEY_LEAVES) || "0") + 1;
      localStorage.setItem(KEY_LEAVES, String(n));
      leavesEl.textContent = `Leaves of Stillness: ${n}`;
    }
    function getHistory(){
      try { return JSON.parse(localStorage.getItem(KEY_HISTORY) || "[]"); }
      catch(e){ return []; }
    }
    function setHistory(arr){
      localStorage.setItem(KEY_HISTORY, JSON.stringify(arr.slice(0, 30)));
    }
    function addHistory(item){
      const arr = getHistory();
      arr.unshift(item);
      setHistory(arr);
    }
    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, m => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
      }[m]));
    }
    function renderHistory(){
      const arr = getHistory();
      if(!arr.length){
        historyList.innerHTML = `<div class="text-sm text-zinc-500 py-6">No record yet. The first ripple will be written here.</div>`;
        return;
      }
      historyList.innerHTML = arr.map((x) => `
        <div class="py-4 border-b border-white/5">
          <div class="text-[10px] uppercase tracking-widest text-zinc-500">${new Date(x.ts).toLocaleString()}</div>
          <div class="mt-2 text-sm text-zinc-200">${escapeHtml(x.q)}</div>
          <div class="mt-2 text-sm italic text-emerald-200/90">‚Äú${escapeHtml(x.a)}‚Äù</div>
        </div>
      `).join("");
    }

    loadLeaves();

    function setLoading(isLoading){
      if(isLoading) portalEl.classList.add("listening");
      else portalEl.classList.remove("listening");
      err.classList.add("hidden");

      if(isLoading){
        reflectBtn.disabled = true;
        reflectBtn.textContent = "Listening‚Ä¶";
        reflectBtn.classList.add("opacity-70");
      }else{
        reflectBtn.disabled = false;
        reflectBtn.textContent = "Reflect";
        reflectBtn.classList.remove("opacity-70");
      }
    }

    function stripTravelerPrefix(s){
      return s.replace(/^\s*traveler[,Ôºö:]?\s*/i, "").trim();
    }

    function parseMirrorAnswer(raw){
      let text = String(raw || "").trim();
      text = text.replace(/[ü™ûüåäüçÉüåÄ‚öõÔ∏è‚âã]+$/g, "").trim();

      let guide = "";
      const gMatch = text.match(/Guiding Question:\s*([\s\S]*)$/i);
      if(gMatch){
        guide = gMatch[1].trim();
        text = text.slice(0, gMatch.index).trim();
      }

      let resonance = "";
      const rMatch = text.match(/Reflection Resonance:\s*([\s\S]*)$/i);
      if(rMatch){
        resonance = rMatch[1].trim();
        text = text.slice(0, rMatch.index).trim();
      }

      const main = stripTravelerPrefix(text);

      return {
        main: main || "Stillness yields truth.",
        resonance: resonance || "Roots deepen.",
        guide: guide || "What remains when urgency leaves?"
      };
    }

    function localFallback(q){
      const val = q.toLowerCase();
      if(val.includes("price") || val.includes("money") || val.includes("pump") || val.includes("moon")){
        return {
          main: "The pond does not track the price of ghosts.",
          echo: "ECHO: CANON SHIELD ACTIVE",
          res:  "RESONANCE: ATTENTION RELEASED",
          guide:"What would you ask if no number could save you?"
        };
      }
      return {
        main: "Every frantic move is a debt to time.",
        echo: "ECHO: STILLNESS YIELDS TRUTH",
        res:  "RESONANCE: ROOTS DEEPEN.",
        guide:"What remains when urgency leaves?"
      };
    }

    async function askAPI(question){
      const payload = { question, user: "miniapp" };
      const r = await fetch(API_URL, {
        method: "POST",
        mode: "cors",
        cache: "no-store",
        redirect: "follow",
        headers: { "Content-Type":"application/json" },
        body: JSON.stringify(payload)
      });
      if(!r.ok) throw new Error("HTTP " + r.status);
      return await r.json();
    }

    function normalizeAnswer(data){
      if(typeof data === "string") return data;
      return data?.answer || data?.unified_answer || data?.text || data?.response || "";
    }

    async function processInquiry(qOverride){
      const q = (qOverride ?? input.value).trim();
      if(!q) return;

      setLoading(true);

      try{
        const data = await askAPI(q);
        const a = normalizeAnswer(data);
        const parsed = a ? parseMirrorAnswer(a) : null;

        const out = parsed ? {
          main: parsed.main,
          echo: "ECHO: STILLNESS YIELDS TRUTH",
          res:  `RESONANCE: ${parsed.resonance.toUpperCase()}`,
          guide: parsed.guide
        } : localFallback(q);

        mainText.textContent = `‚Äú${out.main}‚Äù`;
        echoText.textContent = out.echo;
        resText.textContent  = out.res;
        guideText.textContent= out.guide;

        incLeaves();
        addHistory({ ts: Date.now(), q, a: out.main });

        input.value = "";

        setTimeout(updateScrollAffordance, 50);
      }catch(e){
        const out = localFallback(q);
        mainText.textContent = `‚Äú${out.main}‚Äù`;
        echoText.textContent = out.echo;
        resText.textContent  = out.res;
        guideText.textContent= out.guide;
        err.classList.remove("hidden");
        setTimeout(updateScrollAffordance, 50);
      }finally{
        setLoading(false);
      }
    }

    reflectBtn.addEventListener("click", () => processInquiry());
    input.addEventListener("keydown", (e) => { if(e.key === "Enter") processInquiry(); });

    document.querySelectorAll(".preset").forEach(btn => {
      btn.addEventListener("click", () => {
        document.querySelectorAll(".preset").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        const t = btn.getAttribute("data-text") || "";
        input.value = t;
        processInquiry(t);
      });
    });

    function openSheet(){ renderHistory(); sheet.classList.add("open"); }
    function closeSheet(){ sheet.classList.remove("open"); }

    historyBtn.addEventListener("click", openSheet);
    document.getElementById("close-sheet").addEventListener("click", closeSheet);
    document.getElementById("clear-history").addEventListener("click", () => {
      localStorage.removeItem(KEY_HISTORY);
      renderHistory();
    });

    document.getElementById("manual-toggle").addEventListener("click", () => {
      const lines = document.querySelector(".manual-lines");
      if(!lines) return;
      lines.style.display = (lines.style.display === "none") ? "inline" : "none";
    });

    const walletBtn = document.getElementById("wallet-btn");
    let walletState = "disconnected";
    walletBtn.addEventListener("click", async () => {
      if(walletState === "disconnected"){
        walletState = "connecting";
        walletBtn.textContent = "Connecting‚Ä¶";
        walletBtn.classList.add("opacity-70");
        await new Promise(r => setTimeout(r, 700));
        walletState = "connected";
        walletBtn.classList.remove("opacity-70");
        walletBtn.textContent = "0x12‚Ä¶89 (Base)";
      }else{
        walletState = "disconnected";
        walletBtn.textContent = "Connect Wallet (Base)";
      }
    });

    document.getElementById("basescan-btn").addEventListener("click", () => {
      alert("Coming soon: onchain karmic record. (Local history works now.)");
    });

    setTimeout(updateScrollAffordance, 250);
  </script>
</body>
</html>
