<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Toadgod Lore Library</title>
<meta name="theme-color" content="#2f6e4f" />
<style>
  :root{ --bg:#f7f5ef; --paper:#fffdfa; --ink:#2e2e2e; --muted:#666; --accent:#2f6e4f; --ring:rgba(0,0,0,.1); --shadow:0 6px 20px rgba(0,0,0,.08); }
  *{box-sizing:border-box} html,body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.65 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  a{color:var(--accent);text-decoration:none} a:hover{text-decoration:underline}
  header{position:sticky;top:0;z-index:20;background:#ffffffcc;backdrop-filter:saturate(140%) blur(6px);border-bottom:1px solid var(--ring)}
  .wrap{max-width:1180px;margin:0 auto;padding:14px 18px}
  .title{display:flex;gap:12px;align-items:center;justify-content:space-between}
  .title h1{margin:0;font-size:1.35rem}
  .controls{display:flex;gap:8px;flex-wrap:wrap}
  .btn,.pill{background:var(--paper);border:1px solid var(--ring);border-radius:12px;padding:8px 10px;cursor:pointer;box-shadow:var(--shadow);font-size:.95rem}
  .btn:active{transform:translateY(1px)}
  .badge{padding:4px 8px;border-radius:999px;border:1px solid var(--ring);background:var(--paper);font-size:.8rem}
  .hidden{display:none!important}
  main{display:grid;grid-template-columns:360px 1fr;gap:20px;max-width:1180px;margin:16px auto;padding:0 18px}
  aside{align-self:start;background:var(--paper);border:1px solid var(--ring);border-radius:16px;padding:14px;box-shadow:var(--shadow);position:sticky;top:76px}
  aside h3{margin:4px 0 10px;font-size:.95rem;letter-spacing:.06em;text-transform:uppercase;color:var(--muted)}
  form .row{display:flex;gap:10px;margin-bottom:8px}
  form label{display:block;font-size:.85rem;color:var(--muted)}
  input[type=text],input[type=date],textarea{width:100%;padding:8px 10px;border:1px solid var(--ring);border-radius:10px;background:#fff;color:#222}
  textarea{min-height:90px;resize:vertical}
  .hint{font-size:.8rem;color:var(--muted);margin-top:2px}
  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .danger{background:#ffe8e8;border-color:#ffb3b3}
  .success{background:#e8fff0;border-color:#b3ffd3}
  .bar{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
  .content{min-width:0}
  .toc{background:var(--paper);border:1px solid var(--ring);border-radius:16px;padding:14px;box-shadow:var(--shadow);margin-bottom:10px}
  .search{display:flex;gap:8px;margin-bottom:10px}
  .search input{flex:1;padding:8px 10px;border:1px solid var(--ring);border-radius:10px;background:#fff}
  .tags{display:flex;gap:6px;flex-wrap:wrap;margin:10px 0 6px}
  .tag{font-size:.85rem;padding:4px 8px;border:1px solid var(--ring);border-radius:999px;background:#fff;cursor:pointer}
  .tag.active{background:var(--accent);color:#fff;border-color:transparent}
  article.scroll{background:var(--paper);border:1px solid var(--ring);border-radius:18px;box-shadow:var(--shadow);padding:18px;margin:0 0 18px}
  .head{display:flex;flex-wrap:wrap;gap:10px;align-items:baseline}
  .head h2{margin:0;font-size:1.2rem}
  .meta{color:var(--muted);font-size:.95rem}
  .art{margin:10px 0 14px}
  .art img{width:100%;height:auto;border-radius:12px;border:1px solid var(--ring)}
  .twocol{display:grid;grid-template-columns:1fr 1fr;gap:18px}
  .panel{background:#fff;border:1px solid var(--ring);border-radius:14px;padding:14px}
  .panel h3{margin:0 0 6px;font-size:1.02rem;color:var(--accent)}
  .orig{white-space:pre-wrap;font-family:ui-serif,Georgia,"Times New Roman",serif}
  .chips{display:flex;gap:6px;flex-wrap:wrap;margin-top:8px}
  .chip{font-size:.8rem;border:1px solid var(--ring);border-radius:999px;padding:2px 8px;background:#fff}
  .footerbar{display:flex;justify-content:space-between;gap:10px;margin-top:12px;flex-wrap:wrap}
  .footerbar a,.footerbar button{padding:8px 12px;border:1px solid var(--ring);border-radius:10px;background:#fff;text-decoration:none;cursor:pointer}
  .tweet-btn{background:#1d9bf0;color:#fff;border-color:#1d9bf0}
  .tweet-btn:hover{filter:brightness(.95)}
  .muted{color:#999}
  @media(max-width:1060px){main{grid-template-columns:1fr}.twocol{grid-template-columns:1fr}aside{position:relative;top:0}}
</style>
</head>
<body class="admin-off">
<header>
  <div class="wrap title">
    <h1>üê∏ Toadgod Lore Library</h1>
    <div class="controls">
      <span class="badge viewer-note" id="modeBadge">Read-only</span>
      <button class="btn" id="toggleComm">Toggle Commentary</button>
      <button class="btn" id="fontPlus">A+</button>
      <button class="btn" id="fontReset">A</button>
      <button class="btn" id="exportJson">Export JSON</button>
      <label class="btn hidden" id="importWrap" style="cursor:pointer">
        Import JSON<input type="file" id="importJson" accept="application/json" style="display:none">
      </label>
      <button class="btn danger hidden" id="clearAll">Clear All (local)</button>
      <button class="btn" id="enterAdmin">Enter Admin</button>
      <button class="btn hidden" id="exitAdmin">Lock</button>
    </div>
  </div>
</header>

<main>
  <aside id="editor" class="hidden">
    <h3>Editor</h3>
    <div class="bar" style="margin-bottom:10px;">
      <button class="btn success" id="showForm">‚ûï New Lore Entry</button>
      <button class="btn danger hidden" id="hideForm">‚úñ Close</button>
    </div>
    <form id="entryForm" class="hidden">
      <div class="row grid2">
        <div><label>ID<input type="text" id="fid" placeholder="TOBY_T002 or TOBY_L002" required></label></div>
        <div><label>Date<input type="date" id="fdate" required></label></div>
      </div>
      <div class="row"><label>Title<input type="text" id="ftitle" placeholder="People‚Äôs Script" required></label></div>
      <div class="row"><label>Original Lore<textarea id="ftweet"></textarea></label></div>
      <div class="row"><label>Commentary<textarea id="fcomment"></textarea></label></div>
      <div class="row grid2">
        <div><label>Tags<input type="text" id="ftags"></label></div>
        <div><label>Tweet URL<input type="text" id="furl"></label></div>
      </div>
      <div class="row"><label>Image URL<input type="text" id="fimg"></label></div>
      <div class="bar">
        <button class="btn success" id="addEntry">Add Entry</button>
        <button class="btn" id="resetForm" type="reset">Reset</button>
      </div>
      <div id="saveNote" class="hint muted"></div>
    </form>
  </aside>

  <div class="content">
    <div class="toc">
      <div class="search">
        <input id="q" type="search" placeholder="Search text, tags, dates‚Ä¶">
        <button class="pill" id="clear">Clear</button>
      </div>
      <div class="tags" id="tags"></div>
    </div>
    <div id="content"></div>
  </div>
</main>

<footer class="wrap">
  <p class="muted">Entries are stored locally in this browser. Use Export JSON to back up. Admin Mode enables editing and import.</p>
</footer>

<script>
const ADMIN_SHA256 = "1e6f84dce35a5d3aaafc400db6f0f5fdf87bf40ee3e55ffda68a7fa3af8e56e9"; /* sha256("TOADLOCK") */
const ADMIN_KEY = "toadgod:lore:admin";
let isAdmin = localStorage.getItem(ADMIN_KEY) === "1";

const $ = (s,r=document)=>r.querySelector(s);
const $$ = (s,r=document)=>Array.from(r.querySelectorAll(s));

async function sha256Hex(text){
  const buf = new TextEncoder().encode(text);
  const hash = await crypto.subtle.digest("SHA-256", buf);
  return Array.from(new Uint8Array(hash)).map(b=>b.toString(16).padStart(2,"0")).join("");
}

function applyAdminUI(){
  $("#editor").classList.toggle("hidden", !isAdmin);
  $("#importWrap").classList.toggle("hidden", !isAdmin);
  $("#clearAll").classList.toggle("hidden", !isAdmin);
  $("#exitAdmin").classList.toggle("hidden", !isAdmin);
  $("#enterAdmin").classList.toggle("hidden", isAdmin);
  $("#modeBadge").textContent = isAdmin ? "Admin" : "Read-only";
  $$("[data-edit], [data-del]").forEach(b=> b.classList.toggle("hidden", !isAdmin));
}

$("#enterAdmin").addEventListener("click", async ()=>{
  const pw = prompt("Enter admin passphrase:");
  if(!pw) return;
  const h = await sha256Hex(pw.trim());
  if(h===ADMIN_SHA256){ isAdmin=true; localStorage.setItem(ADMIN_KEY,"1"); applyAdminUI(); alert("Admin mode enabled."); }
  else alert("Incorrect passphrase.");
});

$("#exitAdmin").addEventListener("click", ()=>{ isAdmin=false; localStorage.removeItem(ADMIN_KEY); applyAdminUI(); });

/* ‚Ä¶ rest of your script (LORE_DATA, rendering, form handling) remains unchanged ‚Ä¶ */
</script>
</body>
</html>
