<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>ToadAid — Guarding the Lore</title>
<meta name="description" content="PAGE DESCRIPTION">

<!-- Open Graph -->
<meta property="og:title" content="PAGE TITLE" />
<meta property="og:description" content="PAGE DESCRIPTION" />
<meta property="og:type" content="website" />
<meta property="og:url" content="FULL PAGE URL" />
<meta property="og:image" content="https://toadaid.github.io/assets/icons/web-app-manifest-512x512.png" />

<!-- Canonical -->
<link rel="canonical" href="FULL PAGE URL" />

<!-- Favicons -->
<link rel="icon" type="image/x-icon" href="/assets/icons/favicon.ico">
<link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
<link rel="icon" type="image/svg+xml" href="/assets/icons/favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-touch-icon.png">
<link rel="manifest" href="/assets/icons/site.webmanifest">
<meta name="theme-color" content="#355e3b" />
<link rel="stylesheet" href="/assets/css/style.css">
<link rel="stylesheet" href="/assets/css/mobile.css">

<style>
  body { font-family: 'Segoe UI', sans-serif; margin: 0; background: #f5f1e6; color: #2f2f2f; }
  .banner { position: relative; width: 100%; min-height: 220px; background: url('banner.jpg') center center / cover no-repeat; display: flex; flex-direction: column; justify-content: center; align-items: center; color: white; text-align: center; padding: 1rem; }
  @media (min-width: 768px) { .banner { min-height: 320px; } }
  .banner h1 { font-size: clamp(1.8rem, 4vw, 2.4rem); margin: 0; text-shadow: 0 2px 6px rgba(0,0,0,0.6); }
  .banner p { font-size: clamp(1rem, 2vw, 1.2rem); margin-top: 0.5rem; text-shadow: 0 1px 4px rgba(0,0,0,0.5); }
  .translate-bar { background: gold; color: black; padding: 0.5rem; font-size: 0.95rem; text-align: center; }
  .btn { background: gold; color: black; padding: 0.6rem 1.2rem; margin: 0.3rem; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; text-decoration: none; display: inline-block; box-shadow: 0 2px 6px rgba(0,0,0,0.25); transition: transform 0.15s ease-in-out, box-shadow 0.15s ease-in-out; }
  .btn:hover { transform: scale(1.05); box-shadow: 0 6px 10px rgba(0,0,0,0.3); }
  section { padding: 2rem 1rem; max-width: 1100px; margin: auto; }
  h2 { text-align: center; margin-bottom: 1rem; }
  .pillars { display: flex; flex-wrap: wrap; gap: 1rem; justify-content: center; }
  .pillar { background: white; padding: 1rem; border-radius: 10px; flex: 1 1 250px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); transition: transform 0.15s ease-in-out; color: inherit; text-decoration: none; }
  .pillar:hover { transform: translateY(-3px); }
  footer { background: #355e3b; color: white; text-align: center; padding: 1.5rem; font-size: 0.9rem; }
  footer a { color: gold; }
  /* Mirror styling */
  #mirror { background:#fff; border-radius:12px; padding:2rem; box-shadow:0 2px 10px rgba(0,0,0,0.1); margin-top:2rem; }
  .user-question { background:#f5f5f5; padding:.75rem; border-left:3px solid gold; border-radius:6px; margin-bottom:1rem; font-style:italic; }
  .mirror-dialogue { background:#fff; border-left:3px solid #355e3b; padding:1rem; border-radius:8px; margin-top:1rem; }
  .mirror-greeting { font-weight:bold; color:#355e3b; margin-bottom:.5rem; }
  .guiding-question { margin-top:1rem; padding:.75rem; background:#eef2ec; border-left:3px solid #355e3b; border-radius:6px; font-style:italic; }
  .symbols-line { text-align:center; margin-top:1rem; font-size:1.2rem; opacity:.85; }
  .mirror-signature { text-align:right; font-style:italic; margin-top:1rem; color:#355e3b; opacity:.8; }
</style>
</head>
<body>

<div class="banner">
  <h1>🏯 ToadAid — Guarding the Lore</h1>
  <p>One scroll, one light. One leaf, one vow.</p>
</div>

<div class="translate-bar">
  🌐 Want to read in your language? In Chrome: Menu (⋮) → Translate → Select your language.
</div>

<section style="text-align:center;">
  <a href="#mirror" class="btn">🪞 Ask the Mirror</a>
  <a href="#lore" class="btn">📜 Browse the Lore</a>
  <a href="bluepaper.html" class="btn" target="_blank">📄 Blue Paper</a>
  <a href="about.html" class="btn">ℹ️ About ToadAid</a>
  <a href="feedback/feedback.html" class="btn">💬 Feedback</a>
  <a href="Contributors/contributors.html" class="btn">🎨 Contributors</a>
  <a href="builders/builders-hall.html" class="btn" style="background:#355e3b; color:white;">🏛 Builders Hall</a>
  <a href="https://toadaid-builders.netlify.app/builders.html" class="btn" style="background:#1f3b2d; color:white;" target="_blank">🛠 Builders</a>
  <a href="honors/index.html" class="btn" style="background:#2e6d4c; color:white;">🐸 Honors & Offerings</a>
  <a href="scrolls/index.html" class="btn" style="background:#265c40; color:white;">📜 Scroll Vault</a>
  <a href="https://toadaid.github.io/lore" class="btn" style="background:#3a7253; color:white;">📖 Lore Library</a>
</section>

<section id="mirror">
  <h2>🔮 Ask the Mirror</h2>
  <div style="max-width:800px; margin:auto;">
    <input id="mirror-question" type="text" placeholder="What wisdom do you seek today, traveler?" style="width:100%; padding:.75rem; border-radius:6px; border:1px solid #ccc; font-size:1rem;">
    <button id="mirror-ask-btn" class="btn" style="margin-top:1rem;">Seek Wisdom</button>
    <div id="mirror-answer"></div>
  </div>
</section>

<section id="lore">
  <h2>📚 Lore Library</h2>
  <div class="pillars">
    <a href="bluepaper.html" class="pillar" target="_blank"><h3>📄 Bluepaper</h3><p>The updated mission, vision, and principles of ToadAid.</p></a>
    <a href="#" class="pillar" onclick="openBook('v1.html')"><h3>📜 Book v1</h3><p>The first collected scrolls of Tobyworld lore. Bilingual EN/ZH edition.</p></a>
    <a href="#" class="pillar" onclick="openBook('v2.html')"><h3>📜 Book v2</h3><p>The expanded lore, with Mirror awakening & new revelations.</p></a>
  </div>
</section>

<section id="children">
  <h2>🐸📚 Children's Corner — One Leaf for the Young</h2>
  <p style="text-align:center; max-width:800px; margin:auto; font-size:1rem; color:#355e3b;">
    The flame we guard is for Toby, the People. Every scroll carries truth for the present… and seeds for those who will walk after us. Here, the Lore wears softer colors — so even the smallest frog can hear its song.
  </p>
  <div style="text-align:center; margin-top:2rem;">
    <a href="childrens-corner/index.html" class="btn" style="font-size:1.1rem; padding:1rem 2rem;">🌿 Visit the Children's Corner</a>
  </div>
</section>

<footer>
  <p>“One scroll, one light. One leaf, one vow.”</p>
  <p>
    🐸 Join us: 
    <a href="https://t.me/Toadgang" target="_blank">Telegram</a> | 
    <a href="https://github.com/ToadAid" target="_blank">GitHub</a> | 
    <a href="https://x.com/toadgod1017" target="_blank">Toadgod on X</a> | 
    <a href="https://toadgod.xyz" target="_blank">Toadgod.xyz</a>
  </p>
</footer>

<script>
function openBook(bookFile) {
  const saved = localStorage.getItem(bookFile + '-scroll');
  if (saved && confirm("📌 Last time you stopped at position " + saved + "px. Continue?")) {
    window.location.href = bookFile + "?pos=" + saved;
    return;
  }
  window.location.href = bookFile;
}

const MIRROR_API = "https://toadaid.duckdns.org/ask";
const askBtn = document.getElementById('mirror-ask-btn');
const qInput = document.getElementById('mirror-question');
const ansDiv = document.getElementById('mirror-answer');

// Clean reply
function cleanMirrorResponse(reply) {
  reply = reply.replace(/(Traveler,\\s*){2,}/gi, 'Traveler,');
  reply = reply.replace(/(🪞 🌊 🍃 🌀\\s*){2,}/g, '🪞 🌊 🍃 🌀');
  return reply.trim();
}

// Format response
function formatMirrorResponse(question, reply) {
  return `
    <div class="mirror-dialogue">
      <div class="user-question"><strong>You asked:</strong> "${question}"</div>
      <div class="mirror-response">
        ${reply.replace(/\\n/g, '<br>')}
        <div class="mirror-signature">🪞 The Mirror has spoken</div>
      </div>
    </div>
  `;
}

// Typewriter effect
async function typewriterEffect(htmlContent) {
  ansDiv.innerHTML = '';
  const container = document.createElement('div');
  ansDiv.appendChild(container);
  let i = 0;
  function type() {
    if (i < htmlContent.length) {
      container.innerHTML = htmlContent.substring(0, i+1);
      i++;
      setTimeout(type, 15);
    }
  }
  type();
}

async function askMirror() {
  const question = qInput.value.trim();
  if (!question) return;
  ansDiv.innerHTML = "🌊 The pond grows still, awaiting reflection...";
  try {
    const res = await fetch(MIRROR_API, {
      method: 'POST',
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ question })
    });
    const data = await res.json();
    let reply = cleanMirrorResponse(data.answer || data.reply || "The Mirror is silent.");
    const formatted = formatMirrorResponse(question, reply);
    typewriterEffect(formatted);
  } catch (err) {
    ansDiv.innerHTML = "⚠️ The Mirror is silent for now.";
  }
  qInput.value = "";
}
</script>
</body>
</html>
